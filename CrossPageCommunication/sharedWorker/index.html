<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <title>å…±äº«çº¿ç¨‹ Shared Worker</title>
</head>

<body>
  <button id="tab">æ–°å¼€ Tab</button>
  <button id="l-btn">ç‚¹èµ</button>
  <p><span id="likedCount">è¿˜æ²¡æœ‰äººç‚¹èµ</span></span>ğŸ‘</p>
  <script>
    let likedCountEl = document.querySelector("#likedCount");

    let worker = new SharedWorker("./sharedWorker.js");

    console.log('worker.port', worker.port);

    worker.port.start();

    // ç›‘å¬æ¶ˆæ¯
    worker.port.onmessage = function (val) {
      likedCountEl.innerHTML = val.data;
    };

    document.getElementById('tab').onclick = function () {
      // IP åœ°å€ä¸ºæœ¬åœ°èµ·çš„æœåŠ¡
      const windowOpen = window.open('http://127.0.0.1:5500/CrossPageCommunication/sharedWorker/index.html');
    }

    document.getElementById('l-btn').onclick = function () {
      worker.port.postMessage('ç‚¹èµäº†');
    };
  </script>
</body>

</html>